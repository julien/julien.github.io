<!DOCTYPE html>
<html>
  <head>
    <style>
      body{width:100%;height:100%;overflow:hidden;
        text-align:center;font: normal 1.8em monospace;margin:0;}
    </style>
  </head>
<body align="center">
  <canvas id="c"></canvas>
  <script>
    (function () {
      var sCanvas
        , sContext
        , video
        , alpha
        , COLS = 48
        , ROWS = 48
        , MINW = 480
        , MINH = 320;

      window.requestAnimationFrame =
        window.requestAnimationFrame   ||
        window.msRequestAnimationFrame ||
        window.mozRequestAnimationFrame;

      navigator.getUserMedia =
        navigator.getUserMedia ||
        navigator.mozGetUserMedia ||
        navigator.webkitGetUserMedia;

      function draw() {
        var imageData, pixels, tileW, tileH, row, col, x, y, pos, r, g, b;

        window.requestAnimationFrame(draw, sCanvas);

        // draw video to get image data, etc...
        sContext.drawImage(video, 0, 0, sCanvas.width, sCanvas.height);

        imageData = sContext.getImageData(0, 0, sCanvas.width, sCanvas.height);
        pixels = imageData.data;

        // clear canvas, before redrawing
        sContext.clearRect(0, 0, sCanvas.width, sCanvas.height);



        tileW = imageData.width / COLS;
        tileH = imageData.height / ROWS;


        for (row = 0; row < ROWS; row += 1) {
          for (col = 0; col < COLS; col += 1) {

            x = (col * tileW) + (tileW / 2);
            y = (row * tileH) + (tileH / 2);



            pos = (Math.floor(y) * (imageData.width * 4)) + (Math.floor(x) * 4);

            r = pixels[pos];
            g = pixels[pos + 1];
            b = pixels[pos + 2];

            sContext.fillStyle = 'rgb(' + r + ', ' + g + ', ' + b + ');';
            sContext.beginPath();
            sContext.arc(x, y, tileW / 2, 0, Math.PI * 2, false);
            sContext.closePath();
            sContext.fill();
          }
        }
      }

      function onVideoCanPlay(e) {
        var w, h;
        w = ~~Math.min(MINW, video.videoWidth);
        h = ~~Math.min(MINH, video.videoHeight);

        sCanvas.width = video.width = w;
        sCanvas.height = video.height = h;

        draw();
      }

      function onMediaSuccess(e) {
        video = document.createElement('video');
        video.addEventListener('canplay', onVideoCanPlay, false);
        video.autoplay = 'autoplay';
        video.src = window.URL.createObjectURL(e);
      }

      function onMediaError(e) {
        var el = document.createElement('p');
        el.textContent = 'Sorry, couldn\'t access your webcam';
        document.body.appendChild(document.createDocumentFragment().appendChild(el));
      }

      function initialize() {
        sCanvas = document.getElementById('c');
        sContext = sCanvas.getContext('2d');
        alpha = 0;
        if (navigator.getUserMedia) {
          navigator.getUserMedia({video: true}, onMediaSuccess, onMediaError);
        }
      }
      window.onload = initialize;
    }());
  </script>
  <script src="assets/menu.js"></script>
</body>
</html>
