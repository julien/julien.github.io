<!DOCTYPE html>
<html>
  <head>
    <style>
      *{margin:0;padding:0;overflow:hidden;}
      #c {background-color: #000;}
    </style>
  </head>
  <body>
    <canvas id="c" ></canvas>
    <script>
      (function () {
        var SCREEN_WIDTH = window.innerWidth;
        var SCREEN_HEIGHT = window.innerHeight;
        var canvas = document.getElementById("c");
        canvas.width = SCREEN_WIDTH;
        canvas.height = SCREEN_HEIGHT;
        var context = canvas.getContext("2d");

        var particles = [];
        var maxParticles = 200;

        var centerX = SCREEN_WIDTH / 2;
        var centerY = SCREEN_HEIGHT / 2;
        var radius = 50;
        var radiusScale = 1.85;

        window.addEventListener("resize", onResize, false);
        onResize();

        function onResize(e) {
          SCREEN_WIDTH = window.innerWidth;
          SCREEN_HEIGHT = window.innerHeight;
          canvas.width = SCREEN_WIDTH;
          canvas.height = SCREEN_HEIGHT;
        }

        function createParticles() {
          particles = [];
          for(var i = 0; i < maxParticles; i++) {
            var p = {
              size: 1,
              position: {x: Math.random() * centerY, y:  Math.random() * centerY},
              offset: {x: 0, y: 0},
              targetSize: 6,
              fillColor: '#' + Math.round(Math.random() * 0xFFFFFF).toString(16),
              orbit: radius * .5 + (radius * .5 * Math.random()),
              maxOrbit: 30 + Math.random() * 150 - 20,
              speed: .01 + Math.random() * .03

            };
            particles.push(p);
          }
        }

        function loop() {
          context.fillStyle = "rgba(0, 0, 0, 0.5)";
          context.fillRect(0, 0, canvas.width, canvas.height);

          var i;
          for(i = 0; i < maxParticles; i++) {
            var p = particles[i];
            var lp = {x: p.position.x, y: p.position.y};


            p.offset.x += p.speed;
            p.offset.y += p.speed;

            p.position.x = centerX + Math.cos((i) + p.offset.x) * (p.orbit * radiusScale);
            p.position.y = centerY + Math.sin((i) + p.offset.y) * (p.orbit * radiusScale) + Math.random()* .005;


            p.position.x = Math.max( Math.min( p.position.x, SCREEN_WIDTH ), 0 );
            p.position.y = Math.max( Math.min( p.position.y, SCREEN_HEIGHT ), 0 );

            p.orbit += (p.maxOrbit - p.orbit) * .06;
            var diffO = p.maxOrbit - p.orbit
            if(Math.abs(diffO) < 1) {
              p.maxOrbit = 30 + Math.random() * 120 - 20;
            }

            p.size += (p.targetSize - p.size) * Math.random() * .003;
            // know when to stop
            var ds = p.targetSize - p.size;
            if(Math.abs(ds) < 1) {
              p.targetSize = 1 + Math.random() * 10 - 2;
              if(p.targetSize  < 0) {
                p.targetSize *= -1;
              }
            }

            context.beginPath();
            context.fillStyle = p.fillColor;
            context.strokeStyle = p.fillColor;
            context.lineWidth = p.size;
            context.moveTo(lp.x, lp.y);
            context.lineTo(p.position.x, p.position.y);
            context.stroke();
            context.arc(p.position.x, p.position.y, p.size, 0, Math.PI * 2, false);
            context.fill();
          }

          /*for(i = 0; i < maxParticles - 1; i++) {
            var pA = particles[i];
            for(j = 1; j < maxParticles; j++) {
            var pB = particles[j];
            context.moveTo(pA.position.x, pA.position.y);
            context.lineTo(pB.position.x, pB.position.y);
            context.stroke();
            }
            }*/
          requestAnimationFrame(loop);
        }


        createParticles();
        loop();
      }());
    </script>
  </body>
</html>
